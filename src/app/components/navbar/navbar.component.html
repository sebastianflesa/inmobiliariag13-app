<nav class="navbar navbar-expand-lg bg-white border-bottom shadow-sm">
  <div class="container-fluid gap-3">
    <a class="navbar-brand fw-semibold text-primary" routerLink="/" (click)="closeMenu()">
      Inmobiliaria
    </a>
    <button
      class="navbar-toggler"
      type="button"
      (click)="toggleMenu()"
      [attr.aria-expanded]="isMenuOpen"
      aria-controls="navbarNav"
      aria-label="Abrir navegacion"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div
      class="collapse navbar-collapse justify-content-between"
      [class.show]="isMenuOpen"
      id="navbarNav"
    >
      <ul class="navbar-nav align-items-lg-center gap-lg-1 mb-3 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" routerLink="/" routerLinkActive="active" (click)="closeMenu()">Inicio</a>
        </li>
        <ng-container *ngIf="isAuthenticated; else publicLinks">
          <li class="nav-item" *ngFor="let link of protectedLinks">
            <a
              class="nav-link"
              [routerLink]="link.route"
              routerLinkActive="active"
              (click)="closeMenu()"
              >{{ link.label }}</a
            >
          </li>
        </ng-container>
      </ul>

      <div
        class="d-flex flex-column flex-lg-row align-items-lg-center gap-2 w-100 w-lg-auto auth-actions"
      >
        <div
          *ngIf="isAuthenticated && (userName || userEmail)"
          class="d-flex align-items-center gap-2 flex-grow-1 flex-lg-grow-0"
        >
          <button type="button" class="btn btn-outline-primary nav-profile" (click)="goToProfile()">
            <span class="avatar">{{ avatarInitial }}</span>
            <span class="text">
              <span class="d-block fw-semibold">{{ userName || 'Usuario' }}</span>
              <small class="text-muted">{{ userEmail }}</small>
            </span>
          </button>
        </div>

        <div *ngIf="!isAuthenticated" class="d-flex flex-column flex-lg-row gap-2 w-100 w-lg-auto">
          <button type="button" class="btn btn-outline-primary" (click)="openLoginModal()">
            Iniciar sesion
          </button>
          <button type="button" class="btn btn-primary" (click)="openRegisterModal()">
            Registrarse
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>

<ng-template #publicLinks>
  <li class="nav-item">
    <a
      routerLink="/buscar-contrato"
      routerLinkActive="active"
      class="nav-link"
      (click)="closeMenu()"
    >
      Portal de Pago
    </a>
  </li>
</ng-template>
